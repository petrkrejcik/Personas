parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r},p.cache={};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"QH5V":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.updateContent=exports.init=exports.fetchData=exports.connect=void 0;const e="App-Personas";let t=Function,n=Function,i=Function,s=Object;const o=(e={})=>(a(e),new Promise((e,t)=>{gapi.load("client:auth2",()=>{r().then(e)})}));exports.init=o;const a=({onError:e,onSignInChange:s,onUpdate:o})=>{s&&(t=s),o&&(n=o),e&&(i=e)},r=()=>new Promise((e,t)=>{gapi.client.init({apiKey:"AIzaSyBYItpNT8k2Y2AEHz2E2kI2EqMULh5C4m0",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],clientId:"614338309616-st9nui22tf3sa1cm9m1l3nd439n50frg.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/drive.file"}).then(()=>{gapi.auth2.getAuthInstance().isSignedIn.listen(c),c(gapi.auth2.getAuthInstance().isSignedIn.get()),e({isInitiated:!0})})}),c=e=>{t(e)},p=()=>{gapi.auth2.getAuthInstance().isSignedIn.get()?l():gapi.auth2.getAuthInstance().signIn()};exports.connect=p;const l=()=>d().then(u).then(e=>(s=e,Promise.resolve())).then(h);exports.fetchData=l;const d=()=>new Promise((e,t)=>{gapi.client.drive.files.list({q:"name='App-Personas' and trashed=false"}).execute(t=>{0===t.files.length?g().then(e):e(t.files[0].id)})}),g=()=>new Promise((t,n)=>{const i={name:e,mimeType:"application/vnd.google-apps.folder"};gapi.client.drive.files.create({resource:i}).execute(e=>{console.info("ðŸ‘‰","created",e),t(e.id)})}),u=e=>new Promise((t,n)=>{gapi.client.drive.files.list({q:`name="persons.json" and '${e}' in parents`}).execute(e=>{0===e.files.length?t(null):t(e.files[0])})}),h=()=>new Promise((e,t)=>{gapi.client.drive.files.get({fileId:s.id,alt:"media"}).execute(t=>{const n=t.result.map(e=>({...e,name:unescape(e.name)}));e(n)})}),m=e=>{gapi.client.request({path:"/upload/drive/v2/files/"+s.id,method:"PUT",alt:"media",body:e}).execute(e=>{e.error?i(`Error during sync: ${e.error.message}`):h().then(n)})};exports.updateContent=m;
},{}],"Iw//":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setState=exports.dispatchUpdate=exports.getState=exports.addListener=void 0;const t=[];let e={googleSyncEnabled:!1,isSignedIn:!1,persons:[],isLoading:!0};const s=()=>e;exports.getState=s;const o=t=>{e={...e,...t},p()};exports.setState=o;const p=()=>{t.forEach(t=>{t(s())})};exports.dispatchUpdate=p;const r=e=>{t.push(e)};exports.addListener=r;
},{}],"thyU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setup=exports.libLoaded=void 0;var e=require("./google-drive-api.js"),t=require("./state.js");const o=()=>{(0,t.addListener)(s),c().addEventListener("click",e.connect)};exports.setup=o;const n=()=>{const o={onSignInChange:a,onUpdate:i,onError:r};(0,e.init)(o).then(e=>{const{isInitiated:o}=e;(0,t.setState)({googleSyncEnabled:o})})};exports.libLoaded=n;const s=e=>{d(e.googleSyncEnabled)},i=e=>{(0,t.setState)({persons:e,isLoading:!1})},a=o=>{o?((0,t.setState)({isSignedIn:o,isLoading:!0}),(0,e.fetchData)().then(i)):(0,t.setState)({isSignedIn:o,isLoading:!1})},r=e=>{(0,t.setState)({isLoading:!1}),alert(e)},d=e=>{e&&c().removeAttribute("disabled")},c=()=>document.querySelector('button[data-prs="googleDriveButton"]');
},{"./google-drive-api.js":"QH5V","./state.js":"Iw//"}],"xLSG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.renderPersons=exports.clearPersons=void 0;var e=require("./state.js");const n=(e,n)=>{const r=document.querySelector(".persons");e.map(t).forEach(e=>r.appendChild(e)),r.appendChild(l(n))};exports.renderPersons=n;const t=(e,n)=>{const t=document.createElement("div");return t.classList.add("person"),[r(e.name),o(e.birthday,e.age,e.daysToBirthday),s(e.seenBefore,n,e.resetSeen),...a(e.customTexts)].filter(Boolean).forEach(e=>t.appendChild(e)),t},r=e=>{const n=d(e);return n.classList.add("person-title"),n},d=e=>{const n=document.createElement("div");return n.innerHTML=e,n},o=(e,n,t)=>{if(!e)return null;const r=document.createElement("div");return r.innerHTML=`Age: ${n}<br />Birthday in ${t} days (${e})`,r},s=(e,n,t)=>{if(!e)return null;const r=document.createElement("div"),d=document.createElement("button");return d.classList.add("buttonSeen"),d.innerText="Today",d.addEventListener("click",t.bind(null,n)),r.innerHTML=`Seen before ${e} days`,r.appendChild(d),r},a=e=>e?e.map(d):[],c=()=>{document.querySelector(".persons").innerHTML=""};exports.clearPersons=c;const l=e=>{const n=document.createElement("div"),t=document.createElement("input"),r=document.createElement("input"),d=document.createElement("button");return t.placeholder="Name",r.placeholder="Birthday (YYYY-MM-DD)",d.innerHTML="Save",d.addEventListener("click",()=>{e(t.value,r.value)}),n.appendChild(t),n.appendChild(r),n.appendChild(d),n};
},{"./state.js":"Iw//"}],"pIMj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setup=exports.resetSeen=exports.addPerson=void 0;var e=require("./state.js"),t=require("./google-drive-api.js"),r=n(require("./persons-view.js"));function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}const a=()=>{(0,e.addListener)(s)};exports.setup=a;const s=()=>{o()},o=()=>{r.clearPersons(),i((0,e.getState)().persons)},i=e=>{const t=e.map(e=>({...e,age:u(e.birthday),daysToBirthday:l(e.birthday),seenBefore:p(e.seen),resetSeen:h})).sort(d);r.renderPersons(t,c)},d=(e,t)=>e.birthday&&t.birthday?l(e.birthday)-l(t.birthday):0,u=e=>{if(!e)return null;const t=Date.now(),r=new Date(e).getTime(),n=new Date(t-r);return Math.abs(n.getUTCFullYear()-1970)},p=e=>{if(!e)return null;const t=Date.now(),r=new Date(e).getTime();return Math.round((t-r)/1e3/60/60/24)},l=e=>{if(!e)return null;const t=new Date(e),r=(new Date).getUTCFullYear(),n=Date.now()-new Date(`${r}-${t.getMonth()+1}-${t.getDate()}`).getTime();let a;if(n<0)a=Math.abs(Math.ceil(n/1e3/60/60/24));else{const e=Date.now()-new Date(`${r+1}-${t.getMonth()+1}-${t.getDate()}`).getTime();a=Math.abs(Math.ceil(e/1e3/60/60/24))}return a},c=(r,n)=>{const a=g(r,n);a?alert(a):((0,e.setState)({isLoading:!0}),(0,t.updateContent)((0,e.getState)().persons.concat({name:r,birthday:n})))};exports.addPerson=c;const g=(e,t)=>e?t.match(/^\d{4}-\d{2}-\d{2}$/)?null:"Wrong birthday format. Use YYYY-MM-DD.":"Empty name",h=r=>{const n=(0,e.getState)().persons.map((e,t)=>{if(t!==r)return e;const n=new Date,a=n.getUTCFullYear(),s=(n.getMonth()+1+"").padStart(2,"0"),o=(n.getDate()+"").padStart(2,"0");return{...e,seen:`${a}-${s}-${o}`}});(0,e.setState)({isLoading:!0}),(0,t.updateContent)(n)};exports.resetSeen=h;
},{"./state.js":"Iw//","./google-drive-api.js":"QH5V","./persons-view.js":"xLSG"}],"xFxm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setup=void 0;var e=require("./state.js");const o={overlay:{selector:'div[data-prs="overlay"]',show:"flex"},loader:{selector:'div[data-prs="loader"]',show:"block"},singIn:{selector:'button[data-prs="googleDriveButton"]',show:"block"}},s=e=>{t(o.loader,e.isLoading),t(o.singIn,!e.isSignedIn),t(o.overlay,e.isLoading||!e.isSignedIn)},t=(e,o)=>{document.querySelector(e.selector).style.display=o?e.show:"none"},r=()=>{(0,e.addListener)(s)};exports.setup=r;
},{"./state.js":"Iw//"}],"H99C":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"googleLibLoaded",{enumerable:!0,get:function(){return e.libLoaded}}),exports.setup=void 0;var e=require("./google-drive-model.js"),r=require("./persons-model.js"),o=require("./overlay.js");const t=()=>{(0,e.setup)(),(0,o.setup)(),(0,r.setup)()};exports.setup=t;
},{"./google-drive-model.js":"thyU","./persons-model.js":"pIMj","./overlay.js":"xFxm"}]},{},["H99C"], "prs")
//# sourceMappingURL=/personas/src.1f4b7c54.map