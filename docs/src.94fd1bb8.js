parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"jROX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setProviders=exports.syncEnd=exports.syncStart=exports.ACTIONS=void 0;const t={LIB_LOADED:"data-provider/lib-loaded",SYNC_CLICK:"data-provider/sync-click",SYNC_START:"data-provider/sync-start",SYNC_END:"data-provider/sync-end",LOGIN:"data-provider/login",SET:"data-provider/set"};exports.ACTIONS=t;const e=()=>({type:t.SYNC_START});exports.syncStart=e;const r=()=>({type:t.SYNC_END});exports.syncEnd=r;const s=e=>({type:t.SET,payload:e});exports.setProviders=s;
},{}],"EE7k":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.toggleAdd=exports.saveAll=exports.remove=exports.save=exports.editPerson=exports.editField=exports.ACTIONS=void 0;const e={editField:"person/editField",editPerson:"person/editPerson",save:"person/save",FETCH:"person/fetch",SET:"person/set",ADD:"person/add",REMOVE:"person/remove",TOGGLE_DELETE_OVERLAY:"person/toggleDeleteOverlay",TOGGLE_ADD:"person/toggleAdd"};exports.ACTIONS=e;const o=(o,t)=>({type:e.editField,payload:{field:o,value:t}});exports.editField=o;const t=o=>({type:e.editPerson,payload:o});exports.editPerson=t;const s=o=>({type:e.save,payload:o});exports.save=s;const p=o=>({type:e.REMOVE,payload:o});exports.remove=p;const r=o=>({type:e.SET,payload:o});exports.saveAll=r;const d=o=>({type:e.TOGGLE_ADD,payload:o});exports.toggleAdd=d;
},{}],"uKcU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.reducer=void 0;var e=require("../person/person-actions"),r=require("../data-provider/actions"),a=require("../app/app-action");const s=(s,t)=>{switch(t.type){case e.ACTIONS.save:{const e={...s.persons,[t.payload.id]:t.payload};return{...s,persons:e}}case e.ACTIONS.SET:return{persons:t.payload};case e.ACTIONS.REMOVE:{const{payload:e}=t;if("string"!=typeof e)return s;const{[e]:r,...a}=s.persons;return{...s,persons:a}}case e.ACTIONS.editField:return{...s,personEdit:{...s.personEdit,[t.payload.field]:t.payload.value}};case e.ACTIONS.editPerson:return{...s,personEdit:t.payload};case e.ACTIONS.TOGGLE_DELETE_OVERLAY:return{...s,deleteOverlayId:t.payload};case e.ACTIONS.TOGGLE_ADD:return{...s,isAddingPerson:t.payload};case a.ACTIONS.setActiveElement:return{...s,activeElement:t.payload};case r.ACTIONS.SYNC_START:return{...s,isSyncing:!0};case r.ACTIONS.SYNC_END:return{...s,isSyncing:!1};case r.ACTIONS.SET:return{...s,dataProviders:[...t.payload]};default:return s}};exports.reducer=s;
},{"../person/person-actions":"EE7k","../data-provider/actions":"jROX","../app/app-action":"AW4V"}],"sAcK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getState=exports.dispatch=exports.subscribe=exports.subscribeAfter=void 0;var e=require("./reducer");const s=[],t=[];let r={persons:{}};const o=()=>r;exports.getState=o;const c=e=>{r={...r,...e}},p=r=>{const p=o();if(console.log("ðŸ”Š",r.type,r.payload||""),!r.type)return;const u=(0,e.reducer)(p,r);c(u),s.forEach(e=>{e(r)}),t.forEach(e=>{e(r)})};exports.dispatch=p;const u=e=>{s.push(e)};exports.subscribe=u;const i=e=>{t.push(e)};exports.subscribeAfter=i;
},{"./reducer":"uKcU"}],"AW4V":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getActiveElement=exports.storeActiveElement=exports.ACTIONS=void 0;var e=require("../store/store");const t={setActiveElement:"utils/set-active-element",init:"app/init"};exports.ACTIONS=t;const r=()=>{const e=document.activeElement;if(!e)return{type:""};const r=e.getAttribute("data-prsKey");return r?{type:t.setActiveElement,payload:r}:{type:""}};exports.storeActiveElement=r;const s=()=>{const t=(0,e.getState)().activeElement;return t?document.querySelector(`[data-prsKey=${t}]`):null};exports.getActiveElement=s;
},{"../store/store":"sAcK"}],"JEGA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isSyncOk=exports.default=void 0;var e=require("./actions"),s=require("../app/app-action"),t=require("../store/store"),r=require("../person/person-actions");const a={persons:{},updated:0};var i=s=>{(0,t.subscribeAfter)(h),s.forEach(o),(0,t.dispatch)((0,e.setProviders)(s))};exports.default=i;const o=e=>e.init(),n=(e,s)=>{if(s.updated>e.updated){const t=e;e=s,s=t}return{persons:{...s.persons,...e.persons},updated:e.updated}},d=()=>{return((0,t.getState)().dataProviders||[]).filter(p)},c=e=>e.isLogged(),p=e=>e.isEnabled(),l=e=>({...a,...e}),u=async()=>{(0,t.dispatch)((0,e.syncStart)());const s=d().filter(c),i=s.map(y),o=(await Promise.all(i)).map(l),{persons:p,updated:u}=o.reduce(n,a);(0,t.dispatch)((0,r.saveAll)(p));const g=s.filter((e,s)=>o[s].updated!==u).map(S({persons:p,updated:u}));await Promise.all(g),(0,t.dispatch)((0,e.syncEnd)())},g=async()=>{(0,t.dispatch)((0,e.syncStart)());const s=S({persons:(0,t.getState)().persons}),r=d().filter(c).map(s);await Promise.all(r).catch(e=>console.error("Error during saving",e)),(0,t.dispatch)((0,e.syncEnd)())},m=async()=>{const e=d().filter(e=>!e.isLogged()).map(v);await Promise.all(e).catch(e=>console.error("Error during logging in",e)),u()},v=e=>e.isEnabled()&&e.login?e.login():Promise.resolve(),y=e=>e.get(),S=e=>{const s=(new Date).getTime(),t={...e,updated:e.updated||s};return async e=>{await e.set(t)||Promise.resolve()}},f=()=>{return((0,t.getState)().dataProviders||[]).reduce((e,s)=>e&&s.isEnabled()&&s.isLogged(),!0)};exports.isSyncOk=f;const h=t=>{switch(t.type){case s.ACTIONS.init:u();break;case e.ACTIONS.SYNC_CLICK:m();break;case r.ACTIONS.save:case r.ACTIONS.REMOVE:g()}};
},{"./actions":"jROX","../app/app-action":"AW4V","../store/store":"sAcK","../person/person-actions":"EE7k"}],"hZBy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.div=exports.createDom=exports.addTestAttribute=void 0;const e=(e,t)=>{window&&!window.Cypress||e.setAttribute("data-cy",t)};exports.addTestAttribute=e;const t=(e,t={},s=[])=>{const a=document.createElement(e),o=r(a);return Object.keys(t).map(e=>o(e,t[e])),Array.isArray(s)||(s=[s]),s.filter(Boolean).forEach(e=>{if("string"==typeof e){if("<"===e.trim()[0])return void(a.innerHTML=e);e=document.createTextNode(e)}a.appendChild(e)}),a};exports.createDom=t;const r=t=>(r,s)=>{switch(r){case"onClick":t.addEventListener("click",s);break;case"className":Array.isArray(s)||(s=[s]),s.forEach(e=>t.classList.add(e));break;case"testId":e(t,s);break;default:t.setAttribute(r,s)}},s=(...e)=>t("div",...e);exports.div=s;
},{}],"iUZI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=o;var e=require("../utils/dom"),t=require("../data-provider/actions"),r=require("../store/store");function o(){const o=(0,e.createDom)("button",{onClick:()=>(0,r.dispatch)({type:t.ACTIONS.LOGIN})});return o.innerText="Login",(0,e.div)({},o)}
},{"../utils/dom":"hZBy","../data-provider/actions":"jROX","../store/store":"sAcK"}],"nySV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ROUTES=void 0;const e={home:"/",login:"login",add:"add",edit:"edit"};exports.ROUTES=e;
},{}],"gdkB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.goToLogin=exports.goToHome=exports.goToEdit=exports.goToAdd=exports.ACTIONS=void 0;var o=require("../router/routes");const e={home:"",login:"/login",go:"router/go"};exports.ACTIONS=e;const t=()=>({type:e.go,payload:o.ROUTES.add});exports.goToAdd=t;const r=t=>({type:e.go,payload:`${o.ROUTES.edit}/${t}`});exports.goToEdit=r;const p=()=>({type:e.go,payload:o.ROUTES.home});exports.goToHome=p;const s=()=>({type:e.go,payload:o.ROUTES.login});exports.goToLogin=s;
},{"../router/routes":"nySV"}],"ZbyX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.diffDays=exports.getNow=exports.formatDMY=exports.createIso=exports.createDate=exports.parseDate=void 0;const t=t=>{const e=new Date(t);return{day:e.getDate()+"",month:e.getMonth()+1+"",year:e.getFullYear()+""}};exports.parseDate=t;const e=(t,e,r)=>new Date(r,e-1,t);exports.createDate=e;const r=(t,e,r)=>{const o=t.padStart(2,"0");return`${r}-${e.padStart(2,"0")}-${o}`};exports.createIso=r;const o=e=>{const{day:r,month:o,year:s}=t(e);return`${r}. ${o}. ${s}`};exports.formatDMY=o;const s=()=>{const t=new Date;return[t.getDate(),t.getMonth()+1]};exports.getNow=s;const a=(t,e)=>{const r=(t,e,r)=>new Date([t,r,e].join("-"));if(!t)return null;const[o,s]=t,[a,n]=e,c=s<=n&&o<=a?"2000":"2001",p=r("2000",o,s),D=r(c,a,n).getTime()-p.getTime();return Math.ceil(D/1e3/60/60/24)};exports.diffDays=a;
},{}],"Z2ax":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createId=void 0;const e=e=>e.trim().toLowerCase().split(" ").filter(Boolean).join("-");exports.createId=e;
},{}],"KW1q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getProps=exports.DEFAULTS=void 0;var e=require("../store/store"),t=require("../utils/date"),r=require("../person/person-actions"),a=require("../router/router-actions"),o=require("./person-util");const n={name:"",day:"1",month:"1",year:"1980"};exports.DEFAULTS=n;const s=()=>({persons:d(),isAdd:(0,e.getState)().isAddingPerson,onSave:()=>i(),onCancel:()=>{(0,e.dispatch)((0,r.toggleAdd)(!1)),(0,e.dispatch)((0,r.editPerson)(null))}});exports.getProps=s;const d=()=>{return Object.values((0,e.getState)().persons).map(a=>{const o=(0,t.getNow)(),{day:n,month:s}=(0,t.parseDate)(a.birthday);return{...a,age:c(a.birthday),daysToBirthday:(0,t.diffDays)(o,[parseInt(n,10),parseInt(s,10)]),seenBefore:u(a.seen),onEditClick:a=>{const o=(0,e.getState)().persons[a];if(!o)return void console.error(`Person not found by id: '${a}'`);const{day:n,month:s,year:d}=(0,t.parseDate)(o.birthday);(0,e.dispatch)((0,r.editPerson)({...o,day:n,month:s,year:d}))},onRemoveClick:h,cancelRemove:h,remove:l,save:()=>i(a.id)}}).sort(p)},i=n=>{const{personEdit:s}=(0,e.getState)(),{day:d,month:i,year:p,...c}=s;if(!c.name.trim())return void console.error("Name cannot be empty");const u={id:n||(0,o.createId)(c.name),...c,birthday:(0,t.createIso)(d,i,p)};(0,e.dispatch)((0,r.save)(u)),(0,e.dispatch)((0,a.goToHome)()),(0,e.dispatch)((0,r.toggleAdd)(!1)),(0,e.dispatch)((0,r.editPerson)(null))},p=(e,r)=>{if(!e.birthday||!r.birthday)return 0;const a=(0,t.getNow)(),o=e=>{const{day:r,month:a}=(0,t.parseDate)(e.birthday);return[parseInt(r,10),parseInt(a,10)]};return(0,t.diffDays)(a,o(e))-(0,t.diffDays)(a,o(r))},c=e=>{if(!e)return null;const t=Date.now(),r=new Date(e).getTime(),a=new Date(t-r);return Math.abs(a.getUTCFullYear()-1970)},u=e=>{if(!e)return null;const t=Date.now(),r=new Date(e).getTime();return Math.round((t-r)/1e3/60/60/24)},y=(e,t)=>e?t.match(/^\d{4}-\d{2}-\d{2}$/)?null:"Wrong birthday format. Use YYYY-MM-DD.":"Empty name",h=t=>{(0,e.dispatch)({type:r.ACTIONS.TOGGLE_DELETE_OVERLAY,payload:t})},l=t=>{(0,e.dispatch)({type:r.ACTIONS.REMOVE,payload:t})};
},{"../store/store":"sAcK","../utils/date":"ZbyX","../person/person-actions":"EE7k","../router/router-actions":"gdkB","./person-util":"Z2ax"}],"MtxU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t={edit:'\n\t\t<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n\t\t\t<path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41\n\t\t\t\t0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>\n\t\t\t<path d="M0 0h24v24H0z" fill="none"/>\n\t\t</svg>\n\t',remove:'\n\t\t<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n\t\t\t<path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>\n\t\t\t<path d="M0 0h24v24H0z" fill="none"/>\n\t\t</svg>\n\t',add:'\n\t\t<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n\t\t\t<path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/><path d="M0 0h24v24H0z" fill="none"/>\n\t\t</svg>\n\t',sync:'\n\t\t<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n\t\t\t<path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0\n\t\t\t14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"/><path d="M0 0h24v24H0z" fill="none"/>\n\t\t</svg>\n\t',warn:'\n\t\t<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/>\n\t\t\t<path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/>\n\t\t</svg>\n\t'};exports.default=t;
},{}],"WM5B":[function(require,module,exports) {

},{}],"oqER":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=c;var e=require("../store/store"),t=require("../router/router-actions"),r=require("../person/persons-model"),d=require("../person/person-actions"),s=require("../data-provider/actions"),a=require("../data-provider/data-provider"),n=require("../utils/dom"),i=o(require("../components/icons"));function o(e){return e&&e.__esModule?e:{default:e}}function c(){const e=document.createElement("div"),t=document.createElement("div");return t.classList.add("spaceEl"),e.classList.add("app-header"),(0,n.addTestAttribute)(e,"header"),[u(),t,l(),p()].map(t=>e.appendChild(t)),e}require("./header.css");const u=()=>{const e=document.createElement("h1");return e.classList.add("header__title"),e.innerHTML="Persons",e},l=()=>{const t=["header-button--sync"];let r=null;(0,a.isSyncOk)()||(t.push("header__sync-error"),r=(0,n.div)({className:"header-button--warn",testId:"header-button--warn"},i.default.warn)),(0,e.getState)().isSyncing&&t.push("header__sync-inProgress");return(0,n.div)({className:"header__syncWrap"},[(0,n.div)({className:t,testId:"header-button--sync",onClick:()=>(0,e.dispatch)({type:s.ACTIONS.SYNC_CLICK})},i.default.sync),r])},p=()=>{const t=document.createElement("div");return t.classList.add("header-button--add"),t.setAttribute("data-cy","header-button--add"),t.addEventListener("click",()=>{(0,e.dispatch)((0,d.editPerson)(r.DEFAULTS)),(0,e.dispatch)((0,d.toggleAdd)(!0))}),t.innerHTML=i.default.add,t};
},{"../store/store":"sAcK","../router/router-actions":"gdkB","../person/persons-model":"KW1q","../person/person-actions":"EE7k","../data-provider/actions":"jROX","../data-provider/data-provider":"JEGA","../utils/dom":"hZBy","../components/icons":"MtxU","./header.css":"WM5B"}],"xAPr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.birthdayPicker=void 0;const e=({day:e,month:t,year:n},r)=>{const a=(e,t,n)=>{return Array.from({length:t+1-e},(t,n)=>e+n).map(e=>{const t=document.createElement("option"),r=e+"";return t.innerText=r,t.value=r,n&&r===n&&(t.selected=!0),t})},c=document.createElement("select"),d=document.createElement("select"),o=document.createElement("select");a(1,31,e).forEach(e=>c.appendChild(e)),a(1,12,t).forEach(e=>d.appendChild(e)),a(1900,2019,n).forEach(e=>o.appendChild(e));const s=e=>t=>r(e,t.target.value);return c.addEventListener("change",s("day")),d.addEventListener("change",s("month")),o.addEventListener("change",s("year")),[c,d,o]};exports.birthdayPicker=e;
},{}],"fitr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=r;var e=require("../store/store"),t=require("../components/birthday-picker"),n=require("./person-actions"),a=require("../app/app-action"),o=require("../utils/dom");function r(t){const n=document.createElement("div");n.classList.add("person");const{personEdit:a}=(0,e.getState)();if(!a)throw new Error("Empty `personEdit");return[(0,o.div)({className:["person__column","person__column-grow"]},[s(a.name),d(a.day,a.month,a.year)]),(0,o.div)({className:"person__column"},[i(a,t.onSave),(0,o.div)({className:"person__secondaryButtons"},[p(t.onRemove),c(t.onCancel)])])].map(e=>n.appendChild(e)),n}const s=t=>{const r=document.createElement("input");return r.placeholder="Name",r.classList.add("person__input"),(0,o.addTestAttribute)(r,"add-input--name"),r.setAttribute("data-prsKey","add-input--name"),r.value=t,r.addEventListener("input",t=>{(0,e.dispatch)((0,a.storeActiveElement)()),(0,e.dispatch)((0,n.editField)("name",r.value))}),r},d=(a,o,r)=>{const s=document.createElement("div");s.setAttribute("data-cy","add-input--birthday"),s.classList.add("person__input");const[d,i,c]=(0,t.birthdayPicker)({day:a,month:o,year:r},(t,a)=>{(0,e.dispatch)((0,n.editField)(t,a))});return s.appendChild(d),s.appendChild(i),s.appendChild(c),s},i=(e,t)=>(0,o.createDom)("button",{className:["person__button","person__button--primary"],onClick:t,testId:"add-button--save"},"OK"),c=e=>(0,o.createDom)("span",{className:["button","person__button--secondary"],onClick:e,testId:"add-button--cancel"},"Cancel"),p=e=>(0,o.createDom)("span",{className:["button","person__button--secondary","warning"],onClick:e},"Remove");
},{"../store/store":"sAcK","../components/birthday-picker":"xAPr","./person-actions":"EE7k","../app/app-action":"AW4V","../utils/dom":"hZBy"}],"zpKB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=d;var e=o(require("../components/icons")),t=require("../utils/date"),n=require("../utils/dom"),r=require("../store/store"),s=o(require("./person-add-edit-view"));function o(e){return e&&e.__esModule?e:{default:e}}function d(e){_();const t=document.createElement("div");return t.classList.add("persons"),(0,n.addTestAttribute)(t,"persons"),e.isAdd?t.appendChild((0,s.default)({onSave:e.onSave,onCancel:e.onCancel})):0===e.persons.length&&(t.classList.add("empty"),t.appendChild(a())),e.persons.map(i(e.onCancel)).forEach(e=>t.appendChild(e)),t}require("./person.css");const i=t=>s=>{const{deleteOverlayId:o,personEdit:d}=(0,r.getState)();if(o===s.id)return l(s);if(d&&d.id===s.id)return c(s,t);const i=s.onEditClick.bind(null,s.id);s.onRemoveClick.bind(null,s.id);return(0,n.div)({className:"person",testId:`person-${s.id}`},[(0,n.div)({className:["person__column","person__column-grow"]},[m(s.name),v(s),y(s.seenBefore),...b(s.customTexts)]),(0,n.div)({className:"person__column"},[(0,n.div)({className:["icon-edit","icon"],testId:"edit",onClick:i},e.default.edit)])])},a=()=>(0,n.div)({className:"personsEmpty",testId:"personsEmpty"},["No persons created yetty."]),l=e=>{console.log("ðŸ”Š","renderRemoveOverlay");const t=e.cancelRemove.bind(null,null);return(0,n.div)({className:"person",testId:`person-${e.id}`},[(0,n.div)({className:"person__removeOverlay",testId:"remove-overlay"},[(0,n.createDom)("button",{className:["person__button","person__button--warning"],onClick:t=>e.remove(e.id)},"Remove"),(0,n.createDom)("button",{className:["person__button"],onClick:t},"Cancel")])])},c=(e,t)=>{const n=e.onRemoveClick.bind(null,e.id);return(0,s.default)({onSave:e.save,onCancel:t,onRemove:n})},u=e=>(0,n.div)({className:"person",testId:`person-${e.id}`}),m=e=>{const t=p(e);return t.classList.add("person-title"),(0,n.addTestAttribute)(t,"title"),t},p=e=>{const t=document.createElement("div");return t.innerHTML=e,t},v=({birthday:e,age:r,daysToBirthday:s})=>{if(!e)return null;const o=document.createElement("div");(0,n.addTestAttribute)(o,"birthday");let d=`Age: ${r}<br />Birthday in ${s} days (${(0,t.formatDMY)(e)})`;return 1===s&&(d=`Tomorrow is the ${r+1}'s birthday`),0===s&&(d=`ðŸŽ‰ Today is celebrating ${r} years ðŸŽŠ`),o.innerHTML=d,o},y=e=>{if(!e&&0!==e)return null;const t=document.createElement("div");document.createElement("button");return t.innerHTML=`Seen before ${e} days`,t},b=e=>e?e.map(p):[],_=()=>{const e=document.querySelector(".persons");e&&(e.innerHTML="")};
},{"../components/icons":"MtxU","../utils/date":"ZbyX","../utils/dom":"hZBy","../store/store":"sAcK","./person-add-edit-view":"fitr","./person.css":"WM5B"}],"LLGg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setup=void 0;var e=require("../store/store"),r=require("../data-provider/actions"),t=c(require("../login/login-view")),o=c(require("../header/header")),n=c(require("../person/persons-view")),i=require("../router/routes"),u=require("../router/router-actions"),a=l(require("../person/persons-model")),s=require("../app/app-action");function p(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return p=function(){return e},e}function l(e){if(e&&e.__esModule)return e;var r=p();if(r&&r.has(e))return r.get(e);var t={};if(null!=e){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var i=o?Object.getOwnPropertyDescriptor(e,n):null;i&&(i.get||i.set)?Object.defineProperty(t,n,i):t[n]=e[n]}}return t.default=e,r&&r.set(e,t),t}function c(e){return e&&e.__esModule?e:{default:e}}const d=()=>window.location.pathname.substring(1).split("/")[0],f=e=>{e!==d()&&history.pushState({},"",e)},g=p=>{p.type===u.ACTIONS.go&&f(p.payload);let l=[];switch(d()){case i.ROUTES.login:l.push((0,o.default)(),(0,t.default)({handleLoginClick:()=>(0,e.dispatch)({type:r.ACTIONS.LOGIN})}));break;default:l=[(0,o.default)(),(0,n.default)(a.getProps())]}const c=document.getElementById("app");c.innerHTML="",l.map(e=>c.appendChild(e));const g=(0,s.getActiveElement)();g&&g.focus()},v=()=>{window.onpopstate=g,(0,e.subscribe)(g)};exports.setup=v;
},{"../store/store":"sAcK","../data-provider/actions":"jROX","../login/login-view":"iUZI","../header/header":"oqER","../person/persons-view":"zpKB","../router/routes":"nySV","../router/router-actions":"gdkB","../person/persons-model":"KW1q","../app/app-action":"AW4V"}],"BR5o":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;const e=window.localStorage,t=t=>{console.log("ðŸ”Š","storing to localStorage");const o=JSON.stringify(t);e.setItem("persons",o)},o=()=>{return JSON.parse(e.getItem("persons"))||{}},s=()=>!0,r=()=>!0,n=()=>{};var i={init:n,get:o,set:t,isLogged:r,isEnabled:s};exports.default=i;
},{}],"FwEn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isLogged=exports.save=exports.init=exports.fetchData=exports.login=void 0;const e="App-Personas",t="persons.json";let n=Function,s="",i="",o=null;const r=async(e={})=>(a(e),new Promise((e,t)=>{gapi.load("client:auth2",()=>{l().then(e).catch(t)})}));exports.init=r;const a=({defaultContentOption:e=null,onSignInChange:t=null})=>{t&&(n=t),e&&(o=e)},l=()=>new Promise((e,t)=>{gapi.client.init({apiKey:"AIzaSyBYItpNT8k2Y2AEHz2E2kI2EqMULh5C4m0",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],clientId:"614338309616-st9nui22tf3sa1cm9m1l3nd439n50frg.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/drive.file"}).then(()=>{gapi.auth2.getAuthInstance().isSignedIn.listen(p),p(gapi.auth2.getAuthInstance().isSignedIn.get()),e({isInitiated:!0})}).catch(t)}),p=e=>{n(e)},c=()=>gapi.auth2.getAuthInstance().isSignedIn.get();exports.isLogged=c;const g=async()=>{const{signIn:e,isSignedIn:t}=gapi.auth2.getAuthInstance();return t.get()?Promise.resolve(!0):await e()};exports.login=g;const d=()=>(console.log("ðŸ”Š","fetchingData from API"),u().then(m).then(v));exports.fetchData=d;const u=()=>new Promise((e,t)=>{gapi.client.drive.files.list({q:"name='App-Personas' and trashed=false"}).execute(t=>{"object"==typeof t&&t.files&&(0===t.files.length?h().then(e):(i=t.files[0].id,e()))})}),h=()=>new Promise((t,n)=>{const s={name:e,mimeType:"application/vnd.google-apps.folder"};gapi.client.drive.files.create({resource:s}).execute(e=>{i=e.id,t()})}),m=()=>new Promise((e,t)=>{gapi.client.drive.files.list({q:`name="persons.json" and '${i}' in parents and trashed=false`}).execute(t=>{console.log("ðŸ”Š","response",t),0===t.files.length?f().then(e):(s=t.files[0].id,e())})}),f=()=>new Promise((e,n)=>{const r="-------314159265358979323846",a="\r\n--"+r+"\r\n",l={name:t,mimeType:"application/json",parents:[i]},p=a+"Content-Type: application/json\r\n\r\n"+JSON.stringify(l)+a+"Content-Type: application/json\r\n\r\n"+(o?JSON.stringify(o):"")+"\r\n---------314159265358979323846--";gapi.client.request({path:"/upload/drive/v3/files",method:"POST",params:{uploadType:"multipart"},headers:{"Content-Type":'multipart/related; boundary="'+r+'"'},body:p}).execute(t=>{s=t.id,e()})}),v=()=>(console.log("ðŸ”Š","getFileContent"),new Promise((e,t)=>{console.log("ðŸ”Š","fileId",s),gapi.client.drive.files.get({fileId:s,alt:"media"}).execute(n=>{n.error?t(`Error during file download: ${n.error.message}`):(console.log("response.result",n.result),e(n.result))})})),y=e=>(console.info("ðŸ‘‰","API save"),new Promise((t,n)=>{gapi.client.request({path:"/upload/drive/v2/files/"+s,method:"PUT",alt:"media",body:e}).execute(e=>{e.error?n(`Error during sync: ${e.error.message}`):v().then(e=>{t(e)})})}));exports.save=y;
},{}],"oZ3E":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _googleDriveApi=require("../../data-provider/google-drive/google-drive-api");let _isEnabled=!1;const onLibLoaded=async e=>{const o={onSignInChange:()=>{},onError:onError,defaultContent:[]};await(0,_googleDriveApi.init)({...o,...e}).catch(console.error)},onError=e=>{alert(e)},get=async()=>{console.log("ðŸ”Š","getting from grive");const e=await(0,_googleDriveApi.fetchData)();if("object"!=typeof e)return onError("Unknown reposonse from server"),null;let o={};return Array.isArray(e)?e.forEach(e=>{o[e.id]=e}):o=e.persons,{persons:Object.keys(o).reduce((e,r)=>(e[r]={...o[r],name:unescape(o[r].name)},e),{}),updated:e.updated||0}},init=async()=>{const response=await fetch("https://apis.google.com/js/api.js");eval(await response.text()),await onLibLoaded(),_isEnabled=!0},isEnabled=()=>_isEnabled;var _default={init:init,get:get,set:_googleDriveApi.save,login:_googleDriveApi.login,isLogged:_googleDriveApi.isLogged,isEnabled:isEnabled};exports.default=_default;
},{"../../data-provider/google-drive/google-drive-api":"FwEn"}],"Focm":[function(require,module,exports) {
"use strict";var e=p(require("./data-provider/data-provider")),r=n(require("./store/store")),t=require("./router/router"),o=p(require("./app/use-local-storage")),i=require("./app/app-action"),a=p(require("./data-provider/google-drive/google-drive-model"));function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function n(e){if(e&&e.__esModule)return e;var r=u();if(r&&r.has(e))return r.get(e);var t={};if(null!=e){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(t,i,a):t[i]=e[i]}}return t.default=e,r&&r.set(e,t),t}function p(e){return e&&e.__esModule?e:{default:e}}require("./app/app.css"),window.store=r,window.Cypress&&(window.store=r),(0,e.default)([o.default,a.default]),(0,t.setup)(),r.dispatch({type:i.ACTIONS.init});
},{"./data-provider/data-provider":"JEGA","./store/store":"sAcK","./router/router":"LLGg","./app/use-local-storage":"BR5o","./app/app-action":"AW4V","./data-provider/google-drive/google-drive-model":"oZ3E","./app/app.css":"WM5B"}]},{},["Focm"], null)
//# sourceMappingURL=/Personas/src.94fd1bb8.js.map